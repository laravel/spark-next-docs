<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Plans | Laravel Spark</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,800,800i,900,900i" rel="stylesheet" type="text/css">
    <link rel="apple-touch-icon" sizes="180x180" href="/docs/assets/img/apple-touch-icon.png?v=00aYpBgAp5">
    <link rel="icon" type="image/png" sizes="32x32" href="/docs/assets/img/favicon-32x32.png?v=00aYpBgAp5">
    <link rel="icon" type="image/png" sizes="16x16" href="/docs/assets/img/favicon-16x16.png?v=00aYpBgAp5">
    <link rel="shortcut icon" href="/docs/assets/img/favicon.ico?v=00aYpBgAp5">
    <meta name="description" content="A perfect starting point for your next great idea.">
    <meta name="docsearch:version" content="2.x.x">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/docs/assets/css/0.styles.c0c886bb.css" as="style"><link rel="preload" href="/docs/assets/js/app.95651ca8.js" as="script"><link rel="preload" href="/docs/assets/js/2.e25629a7.js" as="script"><link rel="preload" href="/docs/assets/js/9.9b279207.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.abc10df8.js"><link rel="prefetch" href="/docs/assets/js/11.3605d95f.js"><link rel="prefetch" href="/docs/assets/js/12.965072a7.js"><link rel="prefetch" href="/docs/assets/js/13.ca148558.js"><link rel="prefetch" href="/docs/assets/js/14.382f113d.js"><link rel="prefetch" href="/docs/assets/js/15.be446089.js"><link rel="prefetch" href="/docs/assets/js/16.10ef0c2b.js"><link rel="prefetch" href="/docs/assets/js/17.f62f4989.js"><link rel="prefetch" href="/docs/assets/js/18.be1ab332.js"><link rel="prefetch" href="/docs/assets/js/19.bdc35da2.js"><link rel="prefetch" href="/docs/assets/js/20.ae0c3f38.js"><link rel="prefetch" href="/docs/assets/js/21.fad78231.js"><link rel="prefetch" href="/docs/assets/js/22.3214753d.js"><link rel="prefetch" href="/docs/assets/js/23.c2854556.js"><link rel="prefetch" href="/docs/assets/js/24.9d499e01.js"><link rel="prefetch" href="/docs/assets/js/25.541847d5.js"><link rel="prefetch" href="/docs/assets/js/26.cd5b169e.js"><link rel="prefetch" href="/docs/assets/js/27.47550fce.js"><link rel="prefetch" href="/docs/assets/js/28.e31447b8.js"><link rel="prefetch" href="/docs/assets/js/29.54c4da39.js"><link rel="prefetch" href="/docs/assets/js/3.dc71ae3d.js"><link rel="prefetch" href="/docs/assets/js/30.8819ef2d.js"><link rel="prefetch" href="/docs/assets/js/31.c977b44e.js"><link rel="prefetch" href="/docs/assets/js/32.86d65ba4.js"><link rel="prefetch" href="/docs/assets/js/33.07907b79.js"><link rel="prefetch" href="/docs/assets/js/34.faa735ab.js"><link rel="prefetch" href="/docs/assets/js/35.09e31a23.js"><link rel="prefetch" href="/docs/assets/js/36.b4f36b7c.js"><link rel="prefetch" href="/docs/assets/js/37.eb8ce7c7.js"><link rel="prefetch" href="/docs/assets/js/38.72d71636.js"><link rel="prefetch" href="/docs/assets/js/39.5695320f.js"><link rel="prefetch" href="/docs/assets/js/4.5f6bfe57.js"><link rel="prefetch" href="/docs/assets/js/40.a764658c.js"><link rel="prefetch" href="/docs/assets/js/41.803aa421.js"><link rel="prefetch" href="/docs/assets/js/42.c55c2039.js"><link rel="prefetch" href="/docs/assets/js/43.63f50d56.js"><link rel="prefetch" href="/docs/assets/js/44.ee3a873b.js"><link rel="prefetch" href="/docs/assets/js/45.1ad8fcd1.js"><link rel="prefetch" href="/docs/assets/js/46.4c3e9d67.js"><link rel="prefetch" href="/docs/assets/js/47.8b9e9a5d.js"><link rel="prefetch" href="/docs/assets/js/48.5e3bfa48.js"><link rel="prefetch" href="/docs/assets/js/49.52b310b3.js"><link rel="prefetch" href="/docs/assets/js/5.9e9fc063.js"><link rel="prefetch" href="/docs/assets/js/50.4891d2a2.js"><link rel="prefetch" href="/docs/assets/js/51.16efd940.js"><link rel="prefetch" href="/docs/assets/js/6.78edb7c1.js"><link rel="prefetch" href="/docs/assets/js/7.f0182c65.js"><link rel="prefetch" href="/docs/assets/js/8.c63c2f3a.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.c0c886bb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><img src="/docs/assets/img/logo.svg" alt="Laravel Spark" class="logo"> <span class="site-name can-hide">Laravel Spark</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://spark.laravel.com" target="_self" class="nav-link external">
  Home
  <!----></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Version" class="dropdown-title"><span class="title">Version</span> <span class="arrow down"></span></button> <button type="button" aria-label="Version" class="mobile-dropdown-title"><span class="title">Version</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/1.x/" class="nav-link">
  1.x
</a></li><li class="dropdown-item"><!----> <a href="/docs/2.x/" class="nav-link router-link-active">
  2.x
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://spark.laravel.com" target="_self" class="nav-link external">
  Home
  <!----></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Version" class="dropdown-title"><span class="title">Version</span> <span class="arrow down"></span></button> <button type="button" aria-label="Version" class="mobile-dropdown-title"><span class="title">Version</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/1.x/" class="nav-link">
  1.x
</a></li><li class="dropdown-item"><!----> <a href="/docs/2.x/" class="nav-link router-link-active">
  2.x
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Getting Started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/2.x/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/docs/2.x/installation.html" class="sidebar-link">Installation</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Spark Paddle</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/2.x/spark-paddle/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/docs/2.x/spark-paddle/plans.html" class="sidebar-link">Plans</a></li><li><a href="/docs/2.x/spark-paddle/middleware.html" class="sidebar-link">Middleware</a></li><li><a href="/docs/2.x/spark-paddle/events.html" class="sidebar-link">Events</a></li><li><a href="/docs/2.x/spark-paddle/testing.html" class="sidebar-link">Testing</a></li><li><a href="/docs/2.x/spark-paddle/cookbook.html" class="sidebar-link">Cookbook</a></li><li><a href="/docs/2.x/spark-paddle/customization.html" class="sidebar-link">Customization</a></li><li><a href="/docs/2.x/spark-paddle/upgrade.html" class="sidebar-link">Upgrade</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Spark Stripe</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/2.x/spark-stripe/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/docs/2.x/spark-stripe/plans.html" aria-current="page" class="active sidebar-link">Plans</a></li><li><a href="/docs/2.x/spark-stripe/middleware.html" class="sidebar-link">Middleware</a></li><li><a href="/docs/2.x/spark-stripe/taxes.html" class="sidebar-link">Taxes</a></li><li><a href="/docs/2.x/spark-stripe/events.html" class="sidebar-link">Events</a></li><li><a href="/docs/2.x/spark-stripe/testing.html" class="sidebar-link">Testing</a></li><li><a href="/docs/2.x/spark-stripe/cookbook.html" class="sidebar-link">Cookbook</a></li><li><a href="/docs/2.x/spark-stripe/customization.html" class="sidebar-link">Customization</a></li><li><a href="/docs/2.x/spark-stripe/upgrade.html" class="sidebar-link">Upgrade</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="plans"><a href="#plans" class="header-anchor">#</a> Plans</h1> <p></p><div class="table-of-contents"><ul><li><a href="#defining-payment-plans">Defining Payment Plans</a></li><li><a href="#trial-periods">Trial Periods</a><ul><li><a href="#requiring-a-payment-method-up-front">Requiring A Payment Method Up Front</a></li></ul></li><li><a href="#determining-plan-eligibility">Determining Plan Eligibility</a></li><li><a href="#per-seat-billing-plans">Per-Seat Billing Plans</a><ul><li><a href="#incrementing-decrementing-the-seat-count">Incrementing / Decrementing The Seat Count</a></li></ul></li><li><a href="#determining-subscription-status">Determining Subscription Status</a></li><li><a href="#defining-plan-incentive-text">Defining Plan Incentive Text</a></li><li><a href="#access-a-billable-s-spark-plan">Access A Billable's Spark Plan</a></li><li><a href="#archiving-plans">Archiving Plans</a></li><li><a href="#account-deletion">Account Deletion</a></li></ul></div><p></p> <h2 id="defining-payment-plans"><a href="#defining-payment-plans" class="header-anchor">#</a> Defining Payment Plans</h2> <p><strong>For more information on defining payment plans for your application, please consult the <a href="/docs/2.x/spark-stripe/configuration.html#defining-subscription-plans">plan configuration documentation</a>.</strong></p> <h2 id="trial-periods"><a href="#trial-periods" class="header-anchor">#</a> Trial Periods</h2> <p>By default, the plan configuration in your application's <code>config/spark.php</code> configuration file contains a <code>trial_days</code> option with a value of <code>5</code>. This configuration option determines the amount of time the user is allowed to use your application during their free trial period. You are free to modify this configuration value based on your application's needs.</p> <p>In practical terms, this configuration option simply determines when the <code>onTrial</code> method of the billable model will begin returning <code>false</code> instead of <code>true</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$user</span> <span class="token operator">=</span> <span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">onTrial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The user is still within their trial period...</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="requiring-a-payment-method-up-front"><a href="#requiring-a-payment-method-up-front" class="header-anchor">#</a> Requiring A Payment Method Up Front</h3> <p>Some applications may need to require a payment method up front before beginning a free trial. The Stripe edition of Spark supports this behavior. To get started, you will add a <code>trial_days</code> configuration option to the individual plan configuration array and remove the <code>trial_days</code> configuration option that is within the billable configuration array:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token string single-quoted-string">'user'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'model'</span> <span class="token operator">=&gt;</span> <span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">,</span>
    <span class="token comment">// 'trial_days' =&gt; 5, Remove this configuration option...</span>
    <span class="token string single-quoted-string">'plans'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">'name'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'Standard'</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'short_description'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'This is a short, human friendly description of the plan.'</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'trial_days'</span> <span class="token operator">=&gt;</span> <span class="token number">5</span><span class="token punctuation">,</span>
            <span class="token comment">// ...</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>Now, after a billable model's initial registration, the <code>trialDays</code> method provided by the model instance will return <code>false</code>. You may examine the results of the <code>subscribed</code> method to conditionally show an alert to your user that they should select a subscription plan before beginning to use your application. For example, if you are using the Blade templating language:</p> <div class="language-html extra-class"><pre class="language-html"><code>@if (! Auth::user()-&gt;subscribed())
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        You must <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/billing<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>select a subscription plan<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span> before continuing.
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
@endif
</code></pre></div><h2 id="determining-plan-eligibility"><a href="#determining-plan-eligibility" class="header-anchor">#</a> Determining Plan Eligibility</h2> <p>Sometimes, you may wish to place limitations on a particular billing plan. For example, a project management application might limit users on a particular billing plan to a maximum of 10 projects, while a higher priced plan might allow the creation of up to 20 projects.</p> <p>If you choose to take this approach to billing, you will need to instruct Spark how to determine if a given billable model is eligible to be placed on a particular billing plan. You may accomplish this by modifying the <code>checkPlanEligibility</code> callback registered within your application's <code>App\Providers\SparkServiceProvider</code> class. This callback will be invoked when a billable model attempts to subscribe to or switch to a new subscription plan:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Models<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Validation<span class="token punctuation">\</span>ValidationException</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Spark<span class="token punctuation">\</span>Plan</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Spark<span class="token punctuation">\</span>Spark</span><span class="token punctuation">;</span>

<span class="token class-name static-context">Spark</span><span class="token operator">::</span><span class="token function">billable</span><span class="token punctuation">(</span><span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">checkPlanEligibility</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$billable</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">Plan</span> <span class="token variable">$plan</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$billable</span><span class="token operator">-&gt;</span><span class="token property">projects</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">10</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$plan</span><span class="token operator">-&gt;</span><span class="token property">name</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'Basic'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token class-name static-context">ValidationException</span><span class="token operator">::</span><span class="token function">withMessages</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token string single-quoted-string">'plan'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'You have too many projects for the selected plan.'</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="per-seat-billing-plans"><a href="#per-seat-billing-plans" class="header-anchor">#</a> Per-Seat Billing Plans</h2> <p>Some applications charge users per &quot;seat&quot; instead of a fixed monthly price. For example, a project management application might charge $10 monthly <strong>per project</strong> such that if a user managed five projects they would be billed $50 monthly.</p> <p>If your application will be using per-seat billing, you will likely define a single, monthly plan in your application's <code>config/spark.php</code> configuration file. In addition, you will need to instruct Spark how to calculate the current number of &quot;seats&quot; a billable model is currently using.</p> <p>You may instruct Spark how to calculate the current number of &quot;seats&quot; a billable model is currently using via the <code>chargePerSeat</code> method when configuring a billable model. Typically, this method should be called within the <code>boot</code> method of your application's <code>App\Providers\SparkServiceProvider</code> class:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Models<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Spark<span class="token punctuation">\</span>Spark</span><span class="token punctuation">;</span>

<span class="token class-name static-context">Spark</span><span class="token operator">::</span><span class="token function">billable</span><span class="token punctuation">(</span><span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">chargePerSeat</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'project'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$billable</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token variable">$billable</span><span class="token operator">-&gt;</span><span class="token function">projects</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The first argument accepted by the <code>chargePerSeat</code> method is the term that your application uses to refer to a &quot;seat&quot;. In the case of a project management application, this would be a &quot;project&quot;. The second argument given to the <code>chargePerSeat</code> method should be a closure that accepts the billable model and returns the current number of &quot;seats&quot; occupied by that model.</p> <p>After configuring per-seat billing, Spark will automatically update the wording within your application's billing portal to inform users that billing is calculated on a per-seat basis.</p> <h3 id="incrementing-decrementing-the-seat-count"><a href="#incrementing-decrementing-the-seat-count" class="header-anchor">#</a> Incrementing / Decrementing The Seat Count</h3> <p>The <code>chargePerSeat</code> callback that was explained above will inform Spark of the current seat count that should be used when a customer initiates a subscription. However, you still need to inform Spark when to add or remove a seat when a user is using your application. For example, if building a project management application that bills per project, you would need to inform Spark when a user creates or deletes a project. You can accomplish this by calling the <code>addSeat</code> and <code>removeSeat</code> method:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">addSeat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">removeSeat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="determining-subscription-status"><a href="#determining-subscription-status" class="header-anchor">#</a> Determining Subscription Status</h2> <p>While building your application, you will often need to inspect a user's subscription status and plan to determine if they are allowed to perform a given action. For example, you may not want to let a user create a project if they are subscribed to a billing plan that only allows a specific number of projects to be created. First, you should review the <a href="/docs/2.x/spark-stripe/middleware.html">subscription verification middleware</a> provided by Spark.</p> <p>Additionally, you may always manually inspect a billable model's subscription status using the <a href="https://laravel.com/docs/billing#checking-subscription-status" target="_blank" rel="noopener noreferrer">methods provided by Laravel Cashier<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, which can be especially useful for verifying that a user is subscribed to a particular plan:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">subscribed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The user has an active subscription...</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">subscribedToPrice</span><span class="token punctuation">(</span><span class="token variable">$planId</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'price_id'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The user has a subscription to a plan with a Stripe plan / price ID of &quot;price_id&quot;...</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="defining-plan-incentive-text"><a href="#defining-plan-incentive-text" class="header-anchor">#</a> Defining Plan Incentive Text</h2> <p>Spark allows you to define plan &quot;incentive&quot; text to display to your users. For example, you may wish to display the amount saved by choosing to use a yearly plan vs. a monthly plan. Incentive text is shown in the top right corner of the plan's card:</p> <p><img src="/docs/assets/img/incentive.f515e51f.png" alt="Incentive text example"></p> <p>To define incentive text, you may add <code>monthly_incentive</code> and / or <code>yearly_incentive</code> configuration options to your plan definition:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'name'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'Standard'</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'short_description'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'This is a short, human friendly description of the plan.'</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'monthly_id'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'price_id'</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'yearly_id'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'price_id'</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'yearly_incentive'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'Save 10%'</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'features'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'Feature 1'</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'Feature 2'</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'Feature 3'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="access-a-billable-s-spark-plan"><a href="#access-a-billable-s-spark-plan" class="header-anchor">#</a> Access A Billable's Spark Plan</h2> <p>Sometimes you may wish to access the Spark plan instance for a given billable in order to determine what options are available to the plan. For example, if your plan definition contains the following:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'name'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'Standard'</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'short_description'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'This is a short, human friendly description of the plan.'</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'monthly_id'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'price_id'</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'yearly_id'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'price_id'</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'features'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'options'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'database_backups'</span> <span class="token operator">=&gt;</span> <span class="token constant boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>You may access the plan and options like so:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">sparkPlan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$canCreateBackups</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">sparkPlan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token property">options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'database_backups'</span><span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="archiving-plans"><a href="#archiving-plans" class="header-anchor">#</a> Archiving Plans</h2> <p>If you plan to &quot;archive&quot; or retire a particular plan for your application, you should add the <code>archived</code> configuration option to the plan's configuration array. You should not completely remove the plan's configuration if existing users of your application that have already subscribed to the plan will be allowed to continue their subscription:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token string single-quoted-string">'plans'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'name'</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'Standard'</span><span class="token punctuation">,</span>
        <span class="token comment">// ...</span>
        <span class="token string single-quoted-string">'archived'</span> <span class="token operator">=&gt;</span> <span class="token constant boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="account-deletion"><a href="#account-deletion" class="header-anchor">#</a> Account Deletion</h2> <p>If your application allows users to completely delete their account data, you should ensure that you cancel any subscription plans that the user has subscribed to before you delete their data. Otherwise, the user may continue to be billed even after you have deleted their data. You may cancel their subscription using <a href="https://laravel.com/docs/billing" target="_blank" rel="noopener noreferrer">Laravel Cashier's<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> typical subscription management methods. Depending on the billable types used by your application, you may need to adjust this code to your application's unique needs:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">optional</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">recurring</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">subscription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">cancelNow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/2.x/spark-stripe/configuration.html" class="prev">
        Configuration
      </a></span> <span class="next"><a href="/docs/2.x/spark-stripe/middleware.html">
        Middleware
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.95651ca8.js" defer></script><script src="/docs/assets/js/2.e25629a7.js" defer></script><script src="/docs/assets/js/9.9b279207.js" defer></script>
  </body>
</html>
